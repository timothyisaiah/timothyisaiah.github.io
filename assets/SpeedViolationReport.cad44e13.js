import{_ as m,e as p,m as _,ao as c,o as h,i as u,j as f,n,Q as d,w,F as v}from"./index.7132186e.js";import{Q as x}from"./QTable.6ea0d867.js";import"./QItem.7a439250.js";import"./position-engine.905a284a.js";import"./format.865294d5.js";const b=[{name:"asset_name",label:"Asset Name",field:"asset_name"},{name:"driver_name",label:"Driver Name",field:"driver_name"},{name:"date",label:"Date",field:"date"},{name:"start_time",label:"Start Time",field:"start_time"},{name:"duration",label:"Duration",field:"duration"},{name:"max_speed",label:"Max. Speed [Km/hr]",field:"max_speed"},{name:"address",label:"Address",field:"address"}],k=p({data(){return{columns:b,rows:[]}},computed:{..._("reports",["getReports"])},mounted(){let s=c.findIn(this.getReports.activeReports),r=s[s.findIndex(e=>e.title==="Speed violation report")];if(r){let e=r.sheets;for(let t=0;t<e.length;t++){this.rows.push({asset_name:e[t].header,driver_name:e[t].sections[0].text.split(":")[0],date:"",start_time:"",duration:"",max_speed:"",address:""});let l=e[t].sections[2].data;for(let o=0;o<l.length;o++){this.rows.push({asset_name:"",driver_name:"",date:e[t].sections[2].data[o].header,start_time:"",duration:"",max_speed:"",address:""});let a=l[o].rows;for(let i=0;i<a.length;i++)this.rows.push({asset_name:"",driver_name:"",date:"",start_time:a[i].start_time.v,duration:a[i].duration.v,max_speed:a[i].max_speed.v,address:a[i].max_speed_address.v})}}}},methods:{exportTable(){let s=[];for(let l in this.rows){let o=[];for(let a in this.columns)o[this.columns[a].label]=this.rows[l][this.columns[a].field];s.push(o)}let r="Speed Violation Report.xlsx",e=XLSX.utils.json_to_sheet(s),t=XLSX.utils.book_new();XLSX.utils.book_append_sheet(t,e,"myWorkSheet"),XLSX.writeFile(t,r)}}}),S={class:"full-width q-mt-md",align:"right"};function g(s,r,e,t,l,o){return h(),u(v,null,[f("div",S,[n(d,{flat:"",onClick:r[0]||(r[0]=a=>this.$router.push("/home")),icon:"keyboard_arrow_left",class:"text-positive",title:"Back"})]),n(x,{title:"Speed Violation Report",rows:s.rows,columns:s.columns,"row-key":"asset_name",class:"sticky-column","rows-per-page-options":[10,20]},{"top-right":w(()=>[n(d,{color:"primary","icon-right":"archive",label:"Export to xls","no-caps":"",onClick:s.exportTable},null,8,["onClick"])]),_:1},8,["rows","columns"])],64)}var C=m(k,[["render",g]]);export{C as default};

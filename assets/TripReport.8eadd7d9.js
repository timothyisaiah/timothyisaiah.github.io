import{_ as f,e as w,ao as c,aM as h,m as g,f as b,aN as y,aO as T,r as x,o as k,i as R,j as p,n as r,Q as d,w as n,ar as S,F as V}from"./index.aa0f7823.js";import{Q as C,a as Q,b as u,c as _}from"./QTabPanels.4c515a8e.js";import{Q as v}from"./QTable.5554cf13.js";import"./QResizeObserver.024a44fc.js";import"./rtl.b51694b1.js";import"./touch.70a9dd44.js";import"./selection.d4eb8891.js";import"./use-cache.b0833c75.js";import"./QItem.02e5e39a.js";import"./position-engine.061c6729.js";import"./format.865294d5.js";const $=[{name:"asset_name",label:"Asset Name",field:"asset_name"},{name:"date",label:"Date",field:"date"},{name:"driver_name",label:"Driver Name",field:"driver_name"},{name:"movement_start",label:"Movement Start",field:"movement_start"},{name:"movement_end",label:"Movement End",field:"movement_end"},{name:"total_trip_length",label:"Total trips length, Km",field:"total_trip_length"},{name:"travel_time",label:"Travel Time",field:"travel_time"},{name:"average_speed",label:"Average Speed [km/hr]",field:"average_speed"},{name:"max_speed",label:"Max. Speed [km/hr]",field:"max_speed"},{name:"stop_duration",label:"Stop Duration",field:"stop_duration"}],N=[{name:"asset_name",label:"Asset Name",field:"asset_name"},{name:"trips",label:"Trips",field:"trips"},{name:"trips_length",label:"Total trips Length, km",field:"trips_length"},{name:"travel_time",label:"Travel Time",field:"travel_time"},{name:"average_speed",label:"Average speed, km/h",field:"average_speed"},{name:"max_speed",label:"Max speed, km/h",field:"max_speed"},{name:"idle_duration",label:"Stop duration",field:"idle_duration"},{name:"sensor_all",label:"Fuel consumed by sensors, L",field:"sensor_all"}],M=w({data(){return{rows:[],columns:$,summary_rows:[],summary_columns:N,loading:!0}},async mounted(){let a=c.findIn(this.getReports.activeReports),e=a[a.findIndex(o=>o.title==="Trip report")];if(e&&e.sheets=="Exceeded Memory Limit"&&await h.report.retreiveReport(e.id).then(o=>{e=o.report}),e&&e.sheets[0].header!="No data found"){let o=e.sheets;for(let t=1;t<e.sheets.length;t++){let m=o[t].sections[0].data;for(let s=0;s<m.length;s++)for(let i=0;i<m[s].rows.length;i++)this.rows.push({asset_name:o[t].header,date:m[s].header,driver_name:o[t].sections[0].header,movement_start:m[s].rows[i].from.v,movement_end:m[s].rows[i].to.v,total_trip_length:m[s].rows[i].length.v,travel_time:m[s].rows[i].time.v,average_speed:m[s].rows[i].avg_speed.v,max_speed:m[s].rows[i].max_speed.v,stop_duration:m[s].rows[i].idle_duration.v})}let l=e.sheets[0].sections[0].data;for(let t in l)this.summary_rows.push({asset_name:l[t].header,driver_name:l[t].rows[0].object.v,trips:l[t].rows[0].count.v,trips_length:l[t].rows[0].length.v,travel_time:l[t].rows[0].time.v,average_speed:l[t].rows[0].avg_speed.v,max_speed:l[t].rows[0].max_speed.v,idle_duration:l[t].rows[0].idle_duration.v,sensor_all:l[t].rows[0].sensor_all?l[t].rows[0].sensor_all.v:l[t].rows[0].sensor__all.v})}this.loading=!1},computed:{...g("reports",["getReports"])},methods:{...b("reports",["retreiveReport"]),exportTable(a){let e=a==="summary"?this.summary_rows:this.rows,o=a==="summary"?this.summary_columns:this.columns;y(o,e,"Trip Report.xlsx")},exportCSV(a){let e=a==="summary"?this.summary_rows:this.rows,o=a==="summary"?this.summary_columns:this.columns;T(o,e,"Trip Report.csv")}},setup(){return{tab:x("summary")}}}),A={class:"full-width q-mt-md",align:"right"},B={class:"full-screen fit-screen-content"};function D(a,e,o,l,t,m){return k(),R(V,null,[p("div",A,[r(d,{flat:"",onClick:e[0]||(e[0]=s=>this.$router.push("/home")),icon:"keyboard_arrow_left",class:"text-positive",title:"Back"})]),p("div",B,[r(C,{modelValue:a.tab,"onUpdate:modelValue":e[1]||(e[1]=s=>a.tab=s),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[r(u,{name:"summary",label:"Summary"}),r(u,{name:"detailed",label:"Detailed"})]),_:1},8,["modelValue"]),r(S),r(Q,{modelValue:a.tab,"onUpdate:modelValue":e[6]||(e[6]=s=>a.tab=s),animated:"",class:"full-width"},{default:n(()=>[r(_,{name:"summary"},{default:n(()=>[r(v,{title:"Trip Report Summary",rows:a.summary_rows,columns:a.summary_columns,"row-key":"asset_name",class:"sticky-column","rows-per-page-options":[20,100,200,1e3],loading:a.loading,"virtual-scroll":""},{"top-right":n(()=>[r(d,{color:"primary","icon-right":"download",label:"xls","no-caps":"",onClick:e[2]||(e[2]=s=>a.exportTable("summary"))}),r(d,{color:"primary","icon-right":"download",label:"csv","no-caps":"",class:"q-mx-sm",onClick:e[3]||(e[3]=s=>a.exportCSV("summary"))})]),_:1},8,["rows","columns","loading"])]),_:1}),r(_,{name:"detailed",class:"full-width"},{default:n(()=>[r(v,{title:"Trip Report",rows:a.rows,columns:a.columns,"row-key":"asset_name",class:"sticky-column","rows-per-page-options":[20,100,200,1e3],loading:a.loading,"virtual-scroll":""},{"top-right":n(()=>[r(d,{color:"primary","icon-right":"download",label:"xls","no-caps":"",onClick:e[4]||(e[4]=s=>a.exportTable("detailed"))}),r(d,{color:"primary","icon-right":"download",label:"csv","no-caps":"",class:"q-mx-sm",onClick:e[5]||(e[5]=s=>a.exportTable("detailed"))})]),_:1},8,["rows","columns","loading"])]),_:1})]),_:1},8,["modelValue"])])],64)}var X=f(M,[["render",D]]);export{X as default};

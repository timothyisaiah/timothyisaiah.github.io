import{_ as p,e as d,ao as _,m as v,f as h,o as c,i as u,j as i,n,Q as m,w as f,F as w}from"./index.3289350d.js";import{Q as g}from"./QTable.1a8a0759.js";import"./QItem.cce6c608.js";import"./position-engine.8ff9d6cd.js";import"./format.865294d5.js";const b=[{name:"asset_name",label:"Asset Name",field:"asset_name"},{name:"date",label:"Date",field:"date"},{name:"driver_name",label:"Driver Name",field:"driver_name"},{name:"movement_start",label:"Movement Start",field:"movement_start"},{name:"movement_end",label:"Movement End",field:"movement_end"},{name:"total_trip_length",label:"Total trips length, Km",field:"total_trip_length"},{name:"travel_time",label:"Travel Time",field:"travel_time"},{name:"average_speed",label:"Average Speed [km/hr]",field:"average_speed"},{name:"max_speed",label:"Max. Speed [km/hr]",field:"max_speed"},{name:"stop_duration",label:"Stop Duration",field:"stop_duration"}],x=d({data(){return{rows:[],columns:b}},mounted(){let r=_.findIn(this.getReports.activeReports),l=r[r.findIndex(s=>s.title==="Trip report")];if(l){let s=l.sheets;for(let o=1;o<l.sheets.length;o++){this.rows.push({asset_name:s[o].header,date:"",driver_name:"",movement_start:"",movement_end:"",total_trip_length:"",travel_time:"",average_speed:"",max_speed:"",stop_duration:""});let t=s[o].sections[0].data;for(let e=0;e<t.length;e++){this.rows.push({asset_name:s[o].header,date:t[e].header,driver_name:s[o].sections[0].header,movement_start:"",movement_end:"",total_trip_length:"",travel_time:"",average_speed:"",max_speed:"",stop_duration:""});for(let a=0;a<t[e].rows.length;a++)this.rows.push({asset_name:"",date:"",driver_name:"",movement_start:t[e].rows[a].from.v,movement_end:t[e].rows[a].to.v,total_trip_length:t[e].rows[a].length.v,travel_time:t[e].rows[a].time.v,average_speed:t[e].rows[a].avg_speed.v,max_speed:t[e].rows[a].max_speed.v,stop_duration:t[e].rows[a].idle_duration.v})}}}},computed:{...v("reports",["getReports"])},methods:{...h("reports",["retreiveReport"]),exportTable(){let r=[];for(let t in this.rows){let e=[];for(let a in this.columns)e[this.columns[a].label]=this.rows[t][this.columns[a].field];r.push(e)}let l="Trip Report.xlsx",s=XLSX.utils.json_to_sheet(r),o=XLSX.utils.book_new();XLSX.utils.book_append_sheet(o,s,"myWorkSheet"),XLSX.writeFile(o,l)}}}),k={class:"full-width q-mt-md",align:"right"},y={class:"full-screen fit-screen-content"};function R(r,l,s,o,t,e){return c(),u(w,null,[i("div",k,[n(m,{flat:"",onClick:l[0]||(l[0]=a=>this.$router.push("/home")),icon:"keyboard_arrow_left",class:"text-positive",title:"Back"})]),i("div",y,[n(g,{title:"Trip Report",rows:r.rows,columns:r.columns,"row-key":"asset_name",class:"sticky-column","rows-per-page-options":[10,20,100]},{"top-right":f(()=>[n(m,{color:"primary","icon-right":"archive",label:"Export to xls","no-caps":"",onClick:r.exportTable},null,8,["onClick"])]),_:1},8,["rows","columns"])])],64)}var C=p(x,[["render",R]]);export{C as default};

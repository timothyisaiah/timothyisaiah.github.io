import{_ as f,e as c,ao as b,aM as w,m as h,f as g,aN as y,aO as T,r as x,o as k,i as R,j as p,n as o,Q as d,w as i,ar as S,F as V}from"./index.a1805e5d.js";import{Q as C,a as Q,b as u,c as _}from"./QTabPanels.6d734ffc.js";import{Q as v}from"./QTable.237c86ab.js";import"./QResizeObserver.9d62bad2.js";import"./rtl.b51694b1.js";import"./touch.70a9dd44.js";import"./selection.bfef7e8b.js";import"./use-cache.b0833c75.js";import"./QItem.50e00458.js";import"./position-engine.fbe6e9dd.js";import"./format.865294d5.js";const $=[{name:"asset_name",label:"Asset Name",field:"asset_name"},{name:"date",label:"Date",field:"date"},{name:"driver_name",label:"Driver Name",field:"driver_name"},{name:"movement_start",label:"Movement Start",field:"movement_start"},{name:"movement_end",label:"Movement End",field:"movement_end"},{name:"total_trip_length",label:"Total trips length, Km",field:"total_trip_length"},{name:"travel_time",label:"Travel Time",field:"travel_time"},{name:"average_speed",label:"Average Speed [km/hr]",field:"average_speed"},{name:"max_speed",label:"Max. Speed [km/hr]",field:"max_speed"},{name:"stop_duration",label:"Stop Duration",field:"stop_duration"}],N=[{name:"asset_name",label:"Asset Name",field:"asset_name"},{name:"trips",label:"Trips",field:"trips"},{name:"trips_length",label:"Total trips Length, km",field:"trips_length"},{name:"travel_time",label:"Travel Time",field:"travel_time"},{name:"average_speed",label:"Average speed, km/h",field:"average_speed"},{name:"max_speed",label:"Max speed, km/h",field:"max_speed"},{name:"norm_fuel_consumed",label:"Fuel consumed by norm, L",field:"norm_fuel_consumed"},{name:"trip_cost_norm",label:"Trip cost by norm",field:"trip_cost_norm"},{name:"idle_duration",label:"Stop duration",field:"idle_duration"},{name:"sensor_all",label:"Fuel consumed by sensors, L",field:"sensor_all"},{name:"trip_cost_sensor",label:"Trip fuel cost by sensors",field:"trip_cost_sensor"}],M=c({data(){return{rows:[],columns:$,summary_rows:[],summary_columns:N,loading:!0}},async mounted(){let a=b.findIn(this.getReports.activeReports),e=a[a.findIndex(l=>l.title==="Trip report")];if(e&&e.sheets=="Exceeded Memory Limit"&&await w.report.retreiveReport(e.id).then(l=>{e=l.report}),e&&e.sheets[0].header!="No data found"){let l=e.sheets;for(let t=1;t<e.sheets.length;t++){let m=l[t].sections[0].data;for(let s=0;s<m.length;s++)for(let n=0;n<m[s].rows.length;n++)this.rows.push({asset_name:l[t].header,date:m[s].header,driver_name:l[t].sections[0].header,movement_start:m[s].rows[n].from.v,movement_end:m[s].rows[n].to.v,total_trip_length:m[s].rows[n].length.v,travel_time:m[s].rows[n].time.v,average_speed:m[s].rows[n].avg_speed.v,max_speed:m[s].rows[n].max_speed.v,stop_duration:m[s].rows[n].idle_duration.v})}let r=e.sheets[0].sections[0].data;for(let t in r)this.summary_rows.push({asset_name:r[t].header,driver_name:r[t].rows[0].object.v,trips:r[t].rows[0].count.v,trips_length:r[t].rows[0].length.v,travel_time:r[t].rows[0].time.v,average_speed:r[t].rows[0].avg_speed.v,max_speed:r[t].rows[0].max_speed.v,norm_fuel_consumed:r[t].rows[0].norm_fuel_consumed.v,norm_fuel_cost:r[t].rows[0].norm_fuel_cost.v,idle_duration:r[t].rows[0].idle_duration.v,sensor_all:r[t].rows[0].sensor_all.v,fuel_cost_all:r[t].rows[0].fuel_cost_all.v})}this.loading=!1},computed:{...h("reports",["getReports"])},methods:{...g("reports",["retreiveReport"]),exportTable(a){let e=a==="summary"?this.summary_rows:this.rows,l=a==="summary"?this.summary_columns:this.columns;y(l,e,"Trip Report.xlsx")},exportCSV(a){let e=a==="summary"?this.summary_rows:this.rows,l=a==="summary"?this.summary_columns:this.columns;T(l,e,"Trip Report.csv")}},setup(){return{tab:x("summary")}}}),A={class:"full-width q-mt-md",align:"right"},B={class:"full-screen fit-screen-content"};function D(a,e,l,r,t,m){return k(),R(V,null,[p("div",A,[o(d,{flat:"",onClick:e[0]||(e[0]=s=>this.$router.push("/home")),icon:"keyboard_arrow_left",class:"text-positive",title:"Back"})]),p("div",B,[o(C,{modelValue:a.tab,"onUpdate:modelValue":e[1]||(e[1]=s=>a.tab=s),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[o(u,{name:"summary",label:"Summary"}),o(u,{name:"detailed",label:"Detailed"})]),_:1},8,["modelValue"]),o(S),o(Q,{modelValue:a.tab,"onUpdate:modelValue":e[6]||(e[6]=s=>a.tab=s),animated:"",class:"full-width"},{default:i(()=>[o(_,{name:"summary"},{default:i(()=>[o(v,{title:"Trip Report Summary",rows:a.summary_rows,columns:a.summary_columns,"row-key":"asset_name",class:"sticky-column","rows-per-page-options":[20,100,200,1e3],loading:a.loading,"virtual-scroll":""},{"top-right":i(()=>[o(d,{color:"primary","icon-right":"download",label:"xls","no-caps":"",onClick:e[2]||(e[2]=s=>a.exportTable("summary"))}),o(d,{color:"primary","icon-right":"download",label:"csv","no-caps":"",class:"q-mx-sm",onClick:e[3]||(e[3]=s=>a.exportCSV("summary"))})]),_:1},8,["rows","columns","loading"])]),_:1}),o(_,{name:"detailed",class:"full-width"},{default:i(()=>[o(v,{title:"Trip Report",rows:a.rows,columns:a.columns,"row-key":"asset_name",class:"sticky-column","rows-per-page-options":[20,100,200,1e3],loading:a.loading,"virtual-scroll":""},{"top-right":i(()=>[o(d,{color:"primary","icon-right":"download",label:"xls","no-caps":"",onClick:e[4]||(e[4]=s=>a.exportTable("detailed"))}),o(d,{color:"primary","icon-right":"download",label:"csv","no-caps":"",class:"q-mx-sm",onClick:e[5]||(e[5]=s=>a.exportTable("detailed"))})]),_:1},8,["rows","columns","loading"])]),_:1})]),_:1},8,["modelValue"])])],64)}var X=f(M,[["render",D]]);export{X as default};

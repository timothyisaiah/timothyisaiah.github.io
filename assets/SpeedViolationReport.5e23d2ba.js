import{_ as m,e as p,m as _,ao as u,o as h,i as c,j as f,n,Q as d,w,F as v}from"./index.c5894f0b.js";import{Q as x}from"./QTable.3c8d771e.js";import"./QItem.588ed55a.js";import"./position-engine.e8fba7f8.js";import"./format.865294d5.js";const b=[{name:"asset_name",label:"Asset Name",field:"asset_name"},{name:"driver_name",label:"Driver Name",field:"driver_name"},{name:"date",label:"Date",field:"date"},{name:"start_time",label:"Start Time",field:"start_time"},{name:"duration",label:"Duration",field:"duration"},{name:"max_speed",label:"Max. Speed [Km/hr]",field:"max_speed"},{name:"address",label:"Address",field:"address"}],k=p({data(){return{columns:b,rows:[],loading:!0}},computed:{..._("reports",["getReports"])},mounted(){let e=u.findIn(this.getReports.activeReports),s=e[e.findIndex(t=>t.title==="Speed violation report")];if(s&&s.sheets[0].header!="No data found"){let t=s.sheets;for(let o in t){this.rows.push({asset_name:t[o].header,driver_name:t[o].sections[0].text.split(":")[0],date:"",start_time:"",duration:"",max_speed:"",address:""});let i=t[o].sections[2].data;for(let r=0;r<i.length;r++){this.rows.push({asset_name:"",driver_name:"",date:t[o].sections[2].data[r].header,start_time:"",duration:"",max_speed:"",address:""});let a=i[r].rows;for(let l in a)this.rows.push({asset_name:"",driver_name:"",date:"",start_time:a[l].start_time.v,duration:a[l].duration.v,max_speed:a[l].max_speed.v,address:a[l].max_speed_address.v})}}}this.loading=!1},methods:{exportTable(){let e=[];for(let i in this.rows){let r=[];for(let a in this.columns)r[this.columns[a].label]=this.rows[i][this.columns[a].field];e.push(r)}let s="Speed Violation Report.xlsx",t=XLSX.utils.json_to_sheet(e),o=XLSX.utils.book_new();XLSX.utils.book_append_sheet(o,t,"myWorkSheet"),XLSX.writeFile(o,s)}}}),g={class:"full-width q-mt-md",align:"right"};function S(e,s,t,o,i,r){return h(),c(v,null,[f("div",g,[n(d,{flat:"",onClick:s[0]||(s[0]=a=>this.$router.push("/home")),icon:"keyboard_arrow_left",class:"text-positive",title:"Back"})]),n(x,{title:"Speed Violation Report",rows:e.rows,columns:e.columns,"row-key":"asset_name",class:"sticky-column","rows-per-page-options":[10,20,100,200],loading:e.loading},{"top-right":w(()=>[n(d,{color:"primary","icon-right":"archive",label:"Export to xls","no-caps":"",onClick:e.exportTable},null,8,["onClick"])]),_:1},8,["rows","columns","loading"])],64)}var C=m(k,[["render",S]]);export{C as default};

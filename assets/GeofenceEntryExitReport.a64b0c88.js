import{_,e as h,m as w,ao as g,aM as x,aN as v,aO as b,o as y,i as k,j as R,n,Q as l,w as C,F as E}from"./index.adcf3461.js";import{Q as G}from"./QTable.869613f0.js";import"./QItem.63cc70ca.js";import"./rtl.b51694b1.js";import"./position-engine.f7a12acb.js";import"./selection.e911660f.js";import"./format.865294d5.js";const T=[{name:"assetname",label:"Asset Name",field:"assetname"},{name:"date",label:"Date",field:"date"},{name:"zone_name",label:"Geofence",field:"zone_name"},{name:"out_address",label:"Exit",field:"out_address"},{name:"out_time",label:"Exit Time",field:"out_time"},{name:"in_address",label:"Entrance",field:"in_address"},{name:"in_time",label:"Entrance Time",field:"in_time"},{name:"duration",label:"Duration",field:"duration"}],$=h({data(){return{rows:[],columns:T,loading:!0}},computed:{...w("reports",["getReports"])},async mounted(){let a=g.findIn(this.getReports.activeReports),s=a[a.findIndex(e=>e.title==="Geofence entry/exit events")];if((s&&s.sheets=="Exceeded Memory Limit"||s.sheets==null)&&await x.report.retreiveReport(s.id).then(e=>{s=e.report}).catch(e=>{s=null}),s&&s.sheets[0].header!="No data found"){let e=s.sheets;for(let t in e){let d=e[t].header,i,r,m,c,p,u,f;for(let o in e[t].sections[4].data)i=e[t].sections[4].data[o].header.split(" - ")[0],r=e[t].sections[4].data[o].rows[e[t].sections[4].data[o].rows.length-1].duration.v,m=e[t].sections[4].data[o].rows[e[t].sections[4].data[o].rows.length-1].in_address.v,c=e[t].sections[4].data[o].rows[e[t].sections[4].data[o].rows.length-1].in_time.v,p=e[t].sections[4].data[o].rows[0].out_address.v,u=e[t].sections[4].data[o].rows[0].out_time.v,f=e[t].sections[4].data[o].rows[e[t].sections[4].data[o].rows.length-1].zone_name.v,this.rows.push({assetname:d,date:i,zone_name:f,out_address:p,out_time:u,in_address:m,in_time:c,duration:r})}}this.loading=!1},methods:{exportTable(){v(this.columns,this.rows,"Geofence entry/exit events Report.xlsx")},exportCSV(){b(this.columns,this.rows,"Geofence entry/exit events Report.csv")}}}),z={class:"full-width q-mt-md",align:"right"};function B(a,s,e,t,d,i){return y(),k(E,null,[R("div",z,[n(l,{flat:"",onClick:s[0]||(s[0]=r=>this.$router.push("/home")),icon:"keyboard_arrow_left",class:"text-positive",title:"Back"})]),n(G,{title:"Geofence entry/exit events Report",rows:a.rows,columns:a.columns,"row-key":"asset_name",class:"sticky-column","rows-per-page-options":[10,20,100],loading:a.loading},{"top-right":C(()=>[n(l,{color:"primary","icon-right":"download",label:"xls","no-caps":"",onClick:a.exportTable},null,8,["onClick"]),n(l,{color:"primary","icon-right":"download",label:"csv","no-caps":"",onClick:a.exportCSV,class:"q-mx-sm"},null,8,["onClick"])]),_:1},8,["rows","columns","loading"])],64)}var I=_($,[["render",B]]);export{I as default};
